{% extends "base.html" %}

{% block content %}
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <ul class="breadcrumb-list">
            <li>
                <a href="/"><img src="{{ url_for('static', filename='img/home.svg') }}" alt="" style="width:16px;height:16px;vertical-align:middle;margin-right:4px;">{{ t.NAV_HOME }}</a>
            </li>
            <li class="breadcrumb-separator">></li>
            <li class="current">{{ t.LOGS_TITLE }}</li>
        </ul>
    </nav>

    <!-- 6-Spalten Grid Layout -->
    <div class="grid-container">
        <!-- Log Controls (volle Breite = 6 Spalten) -->
        <div class="col-6">
            <div class="card">
        <h2>{{ t.LOGS_HEADER }}</h2>
        
        <div class="log-controls">
            <select id="log-type" onchange="loadLogs()">
                <option value="current">{{ t.LOGS_FILTER_ALL }}</option>
                <option value="system">System Log (journalctl)</option>
                <option value="archived">Archivierte Logs</option>
            </select>
            
            <select id="log-level" onchange="filterLogs()">
                <option value="all">{{ t.LOGS_FILTER_ALL }}</option>
                <option value="error">{{ t.LOGS_FILTER_ERROR }}</option>
                <option value="warning">{{ t.LOGS_FILTER_WARNING }}</option>
                <option value="info">{{ t.LOGS_FILTER_INFO }}</option>
                <option value="mqtt">MQTT</option>
            </select>
            
            <input type="text" id="log-search" class="log-filter" placeholder="{{ t.ARCHIVE_SEARCH }}" onkeyup="filterLogs()">
            
            <button onclick="loadLogs()"><img src="{{ url_for('static', filename='img/refresh.svg') }}" alt="" style="width:18px;height:18px;vertical-align:middle;margin-right:4px;">{{ t.INDEX_REFRESH }}</button>
            <button class="btn-secondary" onclick="clearLogView()"><img src="{{ url_for('static', filename='img/trash.svg') }}" alt="" style="width:18px;height:18px;vertical-align:middle;margin-right:4px;">{{ t.LOGS_CLEAR }}</button>
            <button class="btn-secondary" onclick="downloadLog()"><img src="{{ url_for('static', filename='img/save.svg') }}" alt="" style="width:18px;height:18px;vertical-align:middle;margin-right:4px;">{{ t.LOGS_DOWNLOAD }}</button>
            
            <label class="auto-refresh-label">
                <input type="checkbox" id="auto-refresh" onchange="toggleAutoRefresh()">
                <span>Auto-Refresh (5s)</span>
            </label>
        </div>
        
        <div id="archived-logs-list" style="display: none;">
            <h3>Verfügbare Log-Dateien:</h3>
            <div class="log-file-list" id="log-files"></div>
        </div>
        
        <div class="log-info" id="log-info">
            <div class="log-info-item">
                <span class="log-info-label">Log-Typ:</span>
                <span class="log-info-value" id="current-log-type">{{ t.LOGS_FILTER_ALL }}</span>
            </div>
            <div class="log-info-item">
                <span class="log-info-label">{{ t.ARCHIVE_ITEMS }}:</span>
                <span class="log-info-value" id="log-lines">0</span>
            </div>
            <div class="log-info-item">
                <span class="log-info-label">{{ t.LOGS_TIMESTAMP }}:</span>
                <span class="log-info-value" id="last-update">-</span>
            </div>
        </div>
        
        <div class="log-viewer" id="log-viewer">
            <pre id="log-content">{{ t.COMMON_LOADING }}</pre>
        </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/logs.js') }}"></script>
{% endblock %}
